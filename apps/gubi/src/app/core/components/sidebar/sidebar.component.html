<p-drawer
  [visible]="isSidebarOpen()"
  [modal]="isMobile()"
  [closable]="false"
  (visibleChange)="layoutService.setIsSidebarOpen($event)"
  [styleClass]="sidebarClass()"
  role="navigation"
  aria-label="Menu principal"
>
  <ng-template #header>
    <a class="flex flex-col items-center justify-center w-full cursor-pointer" [routerLink]="'/spaces'" aria-label="Ir para EspaÃ§os">
      <img [src]="isSidebarExpanded() ? 'gb_name.svg' : 'gb_logo.svg'" alt="Gubi" class="logo w-1/3 lg:w-1/2" />
    </a>
  </ng-template>

  <ng-template #content>
    <div class="flex flex-col h-full pt-40" [ngClass]="{ 'items-center': !isSidebarExpanded() }">
      <div class="flex flex-col gap-3 justify-start">
        @for (item of menuItems; track item.route) {
          <a [routerLink]="item.route">
            <p-button
              [label]="isSidebarExpanded() ? item.label : undefined"
              [icon]="item.icon"
              severity="secondary"
              [styleClass]="(isSidebarExpanded() ? 'w-full !justify-start ' : '') + (isActive(item.route) ? ' brightness-90' : '')"
              [pTooltip]="!isSidebarExpanded() ? item.label : undefined"
              tooltipPosition="right"
            ></p-button>
          </a>
        }
      </div>

      <div class="mt-auto">
        <div class="flex" [ngClass]="{ 'justify-end': isSidebarExpanded() }">
          <p-button
            icon="pi pi-chevron-right"
            class="transition-transform duration-1000 ease-in-out"
            [ngClass]="{ 'rotate-180': isSidebarExpanded() }"
            severity="secondary"
            rounded
            text
            (click)="layoutService.toggleSidebarExpansion()"
            tooltipPosition="right"
          ></p-button>
        </div>
        <hr class="my-4 mx-1 border-t border-0 border-surface" />
        <div class="flex items-center justify-center gap-2 mb-4">
          <app-user-avatar [name]="authService.currentUserEmail" [image]="authService.currentUserPicture" [size]="'large'"></app-user-avatar>
          <span *ngIf="isSidebarExpanded()" class="text-gray-500 font-semibold">
            {{ authService.currentUserName.split(' ')[0] }}
          </span>
        </div>
        <p-button
          [label]="isSidebarExpanded() ? 'Sair' : undefined"
          icon="pi pi-sign-out"
          severity="secondary"
          [styleClass]="isSidebarExpanded() ? 'w-full' : ''"
          (click)="authService.logout()"
          [pTooltip]="!isSidebarExpanded() ? 'Sair' : undefined"
          tooltipPosition="right"
        ></p-button>
      </div>
    </div>
  </ng-template>
</p-drawer>
